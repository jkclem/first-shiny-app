---
title: "Test"
author: "John Clements"
date: "7/28/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(readr)
library(plotly)
library(GGally)
```


# I.

```{r}
# Set the path to the file.
location <- "./Data/"
# Set the file name.
fileName <- "2016 Electoral and Demographic Data - County Level.csv"

# Read in the data.
countyData <- read_csv(paste0(location, fileName),
                      col_types=cols())
```

```{r}
input <- list()
input$histLogScale <- TRUE
input$histVar <- "TotalPop"
input$varXLogScale <- FALSE
input$varYLogScale <- TRUE
input$varX <- "Black"
input$varY <- "PercentClinton"
input$addRegression <- TRUE
```

# Data

```{r}
countyData %>%
  filter(
    State %in% c("Georgia"),
    Winner %in% c("Trump")
  ) %>%
  summarize_if(is.numeric, mean, na.rm=TRUE)

countyData %>%
  filter(
    State %in% c("Georgia"),
    Winner %in% c("Trump")
  ) %>%
  summarize_if(is.numeric, sd, na.rm=TRUE)

countyData %>%
  filter(
    State %in% c("Georgia"),
    Winner %in% c("Trump")
  ) %>%
  summarize_if(is.numeric, min, na.rm=TRUE)

countyData %>%
  filter(
    State %in% c("Georgia"),
    Winner %in% c("Trump")
  ) %>%
  summarize_if(is.numeric, quantile, probs=c(0.25), na.rm=TRUE)

countyData %>%
  filter(
    State %in% c("Georgia"),
    Winner %in% c("Trump")
  ) %>%
  summarize_if(is.numeric, quantile, probs=c(0.5), na.rm=TRUE)

countyData %>%
  filter(
    State %in% c("Georgia"),
    Winner %in% c("Trump")
  ) %>%
  summarize_if(is.numeric, quantile, probs=c(0.75), na.rm=TRUE)

countyData %>%
  filter(
    State %in% c("Georgia"),
    Winner %in% c("Trump")
  ) %>%
  summarize_if(is.numeric, max, na.rm=TRUE)
```


```{r}
filteredCountyData <- countyData %>%
  filter(
    State %in% c("Georgia"),
    Winner %in% c("Trump")
  )

numericSummary <- do.call(cbind, lapply(filteredCountyData[,3:35], summary))

numericSummary <- as.data.frame(t(numericSummary))

numericSummary[c("TotalPop"), ] 
```


# Data Exploration

```{r}
countyData %>%
  filter(State == "Alabama")
```


## Histogram

```{r}
histLogScale <- input$histLogScale
histVar <- input$histVar

if (histLogScale) {
  histPlot <- countyData %>%
    mutate(
      tempVar = pull(log(countyData[, histVar]))
    ) %>%
    ggplot(aes(tempVar)) + 
    geom_histogram(bins=30, fill="purple", color="black") + 
    scale_x_continuous(paste0("log(", histVar, ")")) +
    scale_y_continuous("Frequency") + 
    ggtitle(paste0("Histogram of log(", histVar, ")"))
} else {
  histPlot <- ggplot(countyData, aes_string(histVar)) + 
    geom_histogram(bins=30, fill="purple", color="black") + 
    scale_y_continuous("Frequency") + 
    ggtitle(paste0("Histogram of ", histVar))
}

histPlot
```

## Scatter Plot

```{r}
varXLogScale <- input$varXLogScale 
varYLogScale <- input$varYLogScale
varX <- input$varX 
varY <- input$varY
addRegression <- input$addRegression

if (varXLogScale & varYLogScale) {
  scatterPlot <- countyData %>%
    mutate(
      tempVarX = pull(log(countyData[, varX])),
      tempVarY = pull(log(countyData[, varY]))
    ) %>%
    ggplot(aes(tempVarX, tempVarY)) + 
    geom_point(color="purple", alpha=0.33) + 
    scale_x_continuous(paste0("log(", varX, ")")) +
    scale_y_continuous(paste0("log(", varY, ")")) + 
    ggtitle(paste0("Scatter Plot of log(", 
                   varX, ") vs. log(", varY, ")"))
} else if (varXLogScale & !varYLogScale) {
  scatterPlot <- countyData %>%
    mutate(
      "tempVarX" = pull(log(countyData[, varX]))
    ) %>%
    ggplot(aes_string(x="tempVarX", y=varY)) + 
    geom_point(color="purple", alpha=0.33) + 
    scale_x_continuous(paste0("log(", varX, ")")) +
    scale_y_continuous(varY) + 
    ggtitle(paste0("Scatter Plot of log(", 
                   varX, ") vs. ", varY))
} else if (!varXLogScale & varYLogScale) {
  scatterPlot <- countyData %>%
    mutate(
      "tempVarY" = pull(log(countyData[, varY]))
    ) %>%
    ggplot(aes_string(x=varX, y="tempVarY")) + 
    geom_point(color="purple", alpha=0.33) + 
    scale_x_continuous(varX) +
    scale_y_continuous(paste0("log(", varY, ")")) + 
    ggtitle(paste0("Scatter Plot of ", 
                   varX, " vs. log(", varY, ")"))
} else {
  scatterPlot <- countyData %>%
    ggplot(aes_string(x=varX, y=varY)) + 
    geom_point(color="purple", alpha=0.33) + 
    scale_x_continuous(varX) +
    scale_y_continuous(varY) + 
    ggtitle(paste0("Scatter Plot of ", 
                   varX, " vs. ", varY))
}

if (addRegression) {
  scatterPlot <- scatterPlot +
  geom_smooth(color="grey20")
}
suppressMessages(ggplotly(scatterPlot)) 
```








